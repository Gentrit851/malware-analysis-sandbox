import tkinter as tk
from tkinter import filedialog, messagebox
from file_checker import checkFile


def check_file():
    file_path = filedialog.askopenfilename(title="Select a file to check")
    if not file_path:
        return

    legitimate = checkFile(file_path)
    if legitimate:
        result_label.config(text=f"File {file_path} seems legitimate!", fg="green")
    else:
        result_label.config(text=f"File {file_path} is probably a MALWARE!!!", fg="red")


def main():
    global result_label

    root = tk.Tk()
    root.title("Malware Checker")

    frame = tk.Frame(root, padx=20, pady=20)
    frame.pack(padx=10, pady=10)

    label = tk.Label(frame, text="Select a file to check if it is probable malware or not.", wraplength=400)
    label.pack(pady=10)

    check_button = tk.Button(frame, text="Select File", command=check_file)
    check_button.pack(pady=5)

    result_label = tk.Label(frame, text="", wraplength=400)
    result_label.pack(pady=10)

    root.mainloop()


if __name__ == "__main__":
    main()